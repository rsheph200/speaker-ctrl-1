'use client';

import type { VizFrame } from '@/lib/mqttVisualizer';

/**
 * Captured MQTT visualizer frames to simulate realistic FFT data when the app
 * runs without a live broker connection.
 */
export const dummyVisualizerFrames: VizFrame[] = [
  {
    ts: 1764517659348,
    rate: 22050,
    bins: 64,
    rms: 0.0003418333954864571,
    bars: [
      0.0052145439479201, 0.009145021059560943, 0.14267428050946096, 0.21943175128273218,
      0.08219352169560917, 0.0074159312628540325, 0.006513689316748641, 0.03910250263837504,
      0.06406499798528921, 0.03306066718343688, 0.008856454720514603, 0.004716403095230482,
      0.05202222515590089, 0.059687657132958774, 0.026965235621081947, 0.008196862630229423,
      0.008034607130709042, 0.011668948571065436, 0.013473882483464419, 0.01671258795401583,
      0.01175051783327793, 0.018777957719680563, 0.030984887689009883, 0.014262043326757864,
      0.0016527386256073692, 0.0026184363445381103, 0.006747948841702906, 0.005481870333208863,
      0.004444144302428185, 0.003516470723007351, 0.0019450593946825857, 0.0005784917104945104,
      0.003743176424135422, 0.0019135967216949105, 0.0018806206698022722, 0.0014886408861945627,
      0.0014375081955341781, 0.0015939526584597965, 0.0019467012807833817, 0.001098068845168759,
      0.0007485862934707029, 0.0010721170055281635, 0.0008971248885426398, 0.0006658887277215486,
      0.0005031653319208572, 0.0003656812761953453, 0.0004556286252697722, 0.0003119197860611914,
      0.0004502208245743157, 0.00029581193696820966, 0.0002331945627491502, 0.0002619524695289088,
      0.0002717967480757558, 0.0003482606622273502, 0.0003264692106256403, 0.00031656303916337926,
      0.0002727263006231718, 0.0003125198489854056, 0.0003035882421190689, 0.00031108514300348634,
      0.0002545740449757563, 0.0002840880242961789, 0.00027391889143389534, 0.0002664201550840742,
    ],
  },
  {
    ts: 1764517659557,
    rate: 22050,
    bins: 64,
    rms: 0.00035569112615076994,
    bars: [
      0.004830744580941941, 0.008912002392828728, 0.1399176626136417, 0.216772735583777,
      0.08085488952889969, 0.0033221529002627525, 0.0052841269865375575, 0.02804678149393992,
      0.046337705000171904, 0.04137584225279067, 0.027367891343606603, 0.028000474605367826,
      0.08961095565706267, 0.09250804435638586, 0.030083702716188095, 0.013215806420228514,
      0.01160130214131752, 0.0031385875125706777, 0.0062412891836261435, 0.006096068137677327,
      0.008469972342924922, 0.024024780070914402, 0.04028080042997317, 0.01905647966575207,
      0.003286327799930617, 0.00061098214281558, 0.006266727612157828, 0.008844323309966436,
      0.0046661765475628225, 0.003116911706368018, 0.0021362275662758856, 0.0011538310359696694,
      0.003053484296343143, 0.000994811424723657, 0.0019473332593883098, 0.0010766618888654776,
      0.0006537441176685755, 0.0009994051736132725, 0.0019250983904585794, 0.0012365106130746728,
      0.0004941830045463272, 0.000528705114479894, 0.0006827317148579327, 0.0006108852615713356,
      0.0002783814625260848, 0.00025261525998978706, 0.00030673541790539885, 0.00019154829379197704,
      0.00019735407819240848, 0.00037221289214004323, 0.00030453859976785173, 0.00027299452869104524,
      0.00034523415701960113, 0.00024648892997448864, 0.00029315202492647183, 0.0002160964444956516,
      0.00025308982195034726, 0.00029013245836707137, 0.0003445374225576121, 0.00031220923492229595,
      0.0003273050762587744, 0.0003116994759908697, 0.00027161373819315117, 0.00029909127194418015,
    ],
  },
  {
    ts: 1764517659810,
    rate: 22050,
    bins: 64,
    rms: 0.0003550737174914608,
    bars: [
      0.004326330927490506, 0.008882031271662686, 0.1441705139199971, 0.2243955265528877,
      0.08493477547343066, 0.005534188222124267, 0.010982234083755218, 0.04478399399468733,
      0.05931407365910046, 0.026670905107839146, 0.009433347886663598, 0.030578315554714842,
      0.07779084341110785, 0.05139898726244074, 0.011011626856688064, 0.013284007253745771,
      0.014776529070305192, 0.015644108174271566, 0.009115783661046513, 0.011506211031118985,
      0.013846407602206363, 0.01820324270594587, 0.02727426258086342, 0.013649390045378747,
      0.005136981923271827, 0.0026621936509810457, 0.006042089929608647, 0.008287359970593114,
      0.0024597499623467737, 0.0025616724193951016, 0.0028406107851045295, 0.0006361164795527169,
      0.0018829287810774008, 0.0005631024433178404, 0.0008408995032246913, 0.0005678625963438154,
      0.0004833349045307062, 0.0008180659138330638, 0.0008759273526363208, 0.0009351375577110662,
      0.000510090337129716, 0.000497695488163767, 0.00023460261174896725, 0.00044024529248296,
      0.0004216383355124325, 0.00023834480430432947, 0.00024148432581783393, 0.00022477962469902467,
      0.00032706892121209523, 0.0002482070301129986, 0.0002302709839621359, 0.0002802261035319333,
      0.00021163433803936008, 0.0002677494746573385, 0.0002810223998281914, 0.00029906033623667796,
      0.0003206127347837212, 0.00030671493321400025, 0.00030595480065933234, 0.00030832538036537654,
      0.00028831461093345873, 0.0003003299839758771, 0.0002755709000833173, 0.00028311892457715546,
    ],
  },
  {
    ts: 1764517659899,
    rate: 22050,
    bins: 64,
    rms: 0.0006684753471740911,
    bars: [
      0.012682825407750306, 0.059461231717715245, 0.12426759180166096, 0.18053528465796617,
      0.09589788004755746, 0.09475601586011503, 0.102635287725525, 0.12162518959209151,
      0.024024333879164653, 0.09345032662861989, 0.1186900841502176, 0.0804787009362228,
      0.003920379885772628, 0.0762793685234662, 0.16943315675866116, 0.11887258991672922,
      0.02817571948111568, 0.027477400470034434, 0.05063757185143743, 0.04155488035082598,
      0.018157008836120314, 0.023704475527176482, 0.06664201912027755, 0.055921308116681126,
      0.008245586473982307, 0.02085744562157705, 0.020377916605179524, 0.015407121892152882,
      0.007930165334458844, 0.010389203376605564, 0.00799226968412374, 0.007734918439003676,
      0.0031443990052466716, 0.0022222487282506425, 0.003140563411986992, 0.0012299065079175273,
      0.0016188309606885675, 0.0010599462901074847, 0.0019227820463242101, 0.0010514260729163722,
      0.0008353993682102263, 0.0008232738119650404, 0.0007317187540933057, 0.0003724180837003189,
      0.00032391367867180154, 0.00028241202141796257, 0.00029133522421663873, 0.0003051254225260122,
      0.0002729158858027845, 0.0001963646299819814, 0.0003601375847296672, 0.00029209352530699424,
      0.0003011314105228101, 0.00029815243279726676, 0.00033773498878441114, 0.00030166294037717523,
      0.0003866239653524406, 0.000408957033511365, 0.0003560619902669, 0.00046270379490025035,
      0.00035674114671396, 0.00045396668384286285, 0.00037120470571108926, 0.0002210320071925011,
    ],
  },
  {
    ts: 1764517660019,
    rate: 22050,
    bins: 64,
    rms: 0.0004370898542215506,
    bars: [
      0.008496086471124233, 0.11950992110662968, 0.14917284464206318, 0.18168566364641212,
      0.12602682696203305, 0.012612772210482124, 0.04771372008741143, 0.06358191958279584,
      0.07945310443734545, 0.07569021679362258, 0.02266160251246116, 0.013037070968028532,
      0.03160593756444902, 0.09891216027276575, 0.13126737993408338, 0.03932927283766579,
      0.026986510091415526, 0.010400882105246973, 0.0001229945655639023, 0.004777312790586511,
      0.00623568316436265, 0.012044883602616803, 0.026339146723523783, 0.009702464942587322,
      0.0033760252496929065, 0.004600366447479882, 0.0084008971650256, 0.009319315508852451,
      0.004568990640651262, 0.0026333538504268866, 0.0015062219697090562, 0.0008926842233411654,
      0.0011568565732501565, 0.0008091738223064153, 0.0008024399984930231, 0.0009491781526553654,
      0.0007295251225084455, 0.000723178229817401, 0.0006455702434723456, 0.0005944900741094688,
      0.00032429457036129545, 0.0003553750288657154, 0.00046467469426548065, 0.00021927146475113056,
      0.00024346289651063524, 0.00018341750333435218, 0.0003029780744311697, 0.0002066855251998451,
      0.00022480366523470064, 0.0002516431294351442, 0.000328203135138588, 0.0002447927034778384,
      0.0002756867598328577, 0.0002422551882066862, 0.00030847527630809663, 0.00033560362409748714,
      0.00031132202440331547, 0.0002753062785081162, 0.0003696885722829102, 0.00024295514871511717,
      0.00028339793702663024, 0.00023710157129191555, 0.00022284196233301687, 0.00026769226673990093,
    ],
  },
];

const frameCount = dummyVisualizerFrames.length;

/**
 * Retrieve a frame by index while applying a tiny amount of random variation
 * so consecutive renders feel less repetitive.
 */
export function getDummyVisualizerFrame(index: number): VizFrame {
  const base = dummyVisualizerFrames[index % frameCount];
  const noiseScale = 0.02;
  const bars = base.bars.map(value => {
    const variation = (Math.random() - 0.5) * noiseScale * value;
    return Math.max(0, value + variation);
  });

  return {
    ...base,
    ts: Date.now(),
    bars,
    rms: base.rms * (0.9 + Math.random() * 0.2),
  };
}
